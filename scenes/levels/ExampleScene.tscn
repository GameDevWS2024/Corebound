[gd_scene load_steps=20 format=3 uid="uid://dfkwq6qwtxw25"]

[ext_resource type="PackedScene" uid="uid://clfnjh8aelj66" path="res://scenes/prefabs/Player.tscn" id="1_7owxc"]
[ext_resource type="Texture2D" uid="uid://dweeg6vbxai1c" path="res://scenes/levels/bg.png" id="1_afw7h"]
[ext_resource type="Shader" path="res://scenes/levels/ExampleScene.gdshader" id="1_kbklw"]
[ext_resource type="PackedScene" uid="uid://bbj3at63gfo77" path="res://scenes/prefabs/Obstacle.tscn" id="2_k4yms"]
[ext_resource type="PackedScene" uid="uid://dkcg0yrtwyo0k" path="res://scenes/prefabs/PointLight.tscn" id="3_0raeo"]
[ext_resource type="Script" path="res://scripts/Chat.cs" id="4_jkuxm"]
[ext_resource type="Script" path="res://scripts/Ally.cs" id="5_3hn7i"]
[ext_resource type="Texture2D" uid="uid://cwes7vi2s0gjs" path="res://assets/allie.png" id="6_pjkiq"]
[ext_resource type="Texture2D" uid="uid://4wumowwpchd5" path="res://assets/obstacles/tree.png" id="9_rlba6"]
[ext_resource type="Texture2D" uid="uid://c1ny7wkwa38ry" path="res://assets/CORE/CORE.png" id="10_cpwqm"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_8cl4m"]
shader = ExtResource("1_kbklw")

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_2qsjx"]
polygon = PackedVector2Array(-2540, 2494, 2492, 2514, 2519, -2511, -2569, -2494)

[sub_resource type="TileSet" id="TileSet_rvbeq"]
tile_size = Vector2i(5, 5)
physics_layer_0/collision_layer = 0
physics_layer_0/collision_mask = 0
navigation_layer_0/layers = 3

[sub_resource type="NavigationPolygon" id="NavigationPolygon_7tqeb"]
outlines = Array[PackedVector2Array]([PackedVector2Array(4.008, 4.03443, -5.99, 4.03443, -5.978, -4.74133, 4.006, -4.75536)])

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7ww48"]
size = Vector2(72, 148)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_32v3l"]

[sub_resource type="CircleShape2D" id="CircleShape2D_mtrq3"]
radius = 39.5628

[sub_resource type="RectangleShape2D" id="RectangleShape2D_b7f6i"]
size = Vector2(64.8874, 64.3589)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7i0lq"]
size = Vector2(66.5529, 63.3333)

[node name="Node2D" type="Node2D"]

[node name="TextureRect" type="TextureRect" parent="."]
material = SubResource("ShaderMaterial_8cl4m")
offset_left = -2550.0
offset_top = -2488.0
offset_right = 2516.0
offset_bottom = 2500.0
texture = ExtResource("1_afw7h")

[node name="LightOccluder2D" type="LightOccluder2D" parent="TextureRect"]
modulate = Color(0.099986, 0.099986, 0.099986, 1)
self_modulate = Color(0.0605304, 0.0605303, 0.0605303, 1)
light_mask = 3
visibility_layer = 3
position = Vector2(2550, 2500)
occluder = SubResource("OccluderPolygon2D_2qsjx")
occluder_light_mask = 3

[node name="PointLight2D" parent="." instance=ExtResource("3_0raeo")]
position = Vector2(876, 401)
color = Color(0.365852, 0.353147, 9.62615e-08, 1)
energy = 8.35
shadow_enabled = true
shadow_color = Color(0.0643274, 0.0646954, 0.0657012, 0)
shadow_filter = 1
shadow_filter_smooth = 10.6
texture_scale = 30.0

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="LineEdit" type="LineEdit" parent="CanvasLayer" node_paths=PackedStringArray("_richTextLabel")]
offset_left = -3.0
offset_top = 83.0
offset_right = 364.0
offset_bottom = 185.0
placeholder_text = "Type here to chat"
virtual_keyboard_type = 1
clear_button_enabled = true
script = ExtResource("4_jkuxm")
_systemPromptFile = "res://assets/prompts/example_prompt.txt"
_richTextLabel = NodePath("../RichTextLabel")

[node name="RichTextLabel" type="RichTextLabel" parent="CanvasLayer"]
offset_left = 24.0
offset_top = 198.0
offset_right = 525.0
offset_bottom = 847.0
bbcode_enabled = true
text = "
"
fit_content = true
scroll_following = true

[node name="TileMapLayer" type="TileMapLayer" parent="."]
position = Vector2(-9.53674e-07, -7.62939e-06)
scale = Vector2(0.5, 0.570093)
enabled = false
tile_set = SubResource("TileSet_rvbeq")

[node name="Region" type="NavigationRegion2D" parent="TileMapLayer"]
modulate = Color(0.389287, 0.389287, 0.389287, 1)
self_modulate = Color(0.18359, 0.18359, 0.18359, 1)
top_level = true
light_mask = 3
visibility_layer = 3
position = Vector2(552, 129)
scale = Vector2(500, 570.093)
navigation_polygon = SubResource("NavigationPolygon_7tqeb")
navigation_layers = 3
travel_cost = 0.25

[node name="MeshInstance2D" type="MeshInstance2D" parent="TileMapLayer/Region"]

[node name="Commander" parent="TileMapLayer/Region/MeshInstance2D" instance=ExtResource("1_7owxc")]
light_mask = 4
visibility_layer = 7
position = Vector2(0.341, 0.44959)
scale = Vector2(0.001, 0.001)
slide_on_ceiling = false
_maxSpeed = 250.0
_acceleration = 1000.0

[node name="Camera2D" type="Camera2D" parent="TileMapLayer/Region/MeshInstance2D/Commander"]
light_mask = 2
visibility_layer = 2
zoom = Vector2(0.8, 0.8)
position_smoothing_enabled = true
position_smoothing_speed = 7.0

[node name="CharacterBody2D" type="CharacterBody2D" parent="TileMapLayer/Region/MeshInstance2D"]
position = Vector2(0.55, 0.926165)
scale = Vector2(0.001, 0.001)
collision_layer = 3
collision_mask = 3
script = ExtResource("5_3hn7i")
_playerPath = NodePath("../Commander")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
path_desired_distance = 1500.0
target_desired_distance = 40.0
path_max_distance = 1500.0
navigation_layers = 3
simplify_path = true
avoidance_enabled = true
radius = 214.58
neighbor_distance = 200.0
avoidance_layers = 3
avoidance_mask = 3

[node name="Sprite2D" type="Sprite2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
position = Vector2(315, 135)
texture = ExtResource("6_pjkiq")
offset = Vector2(135, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
position = Vector2(454, 141)
shape = SubResource("RectangleShape2D_7ww48")

[node name="Obstacles" type="Node" parent="TileMapLayer/Region/MeshInstance2D"]

[node name="tree" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
position = Vector2(850, 450)
scale = Vector2(2.33092, 1.47225)
collision_layer = 3
collision_mask = 3
physics_material_override = SubResource("PhysicsMaterial_32v3l")

[node name="NavigationObstacle2D" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/tree"]
position = Vector2(229.094, 292.749)
scale = Vector2(214.508, 387.226)
radius = 100.0
vertices = PackedVector2Array(0.00999999, -0.0385902, 0.21, -0.0894591, 0.194, -0.22277, -0.0179999, -0.257852, -0.148, -0.20523, -0.184, -0.0859509)
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/tree"]
position = Vector2(236.387, 227.543)
shape = SubResource("CircleShape2D_mtrq3")
debug_color = Color(0.882353, 0, 0.0627451, 0.419608)

[node name="TextureRect" type="TextureRect" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/tree"]
offset_left = 57.488
offset_top = -67.9232
offset_right = 1182.49
offset_bottom = 1057.08
scale = Vector2(0.3, 0.3)
texture = ExtResource("9_rlba6")
stretch_mode = 4

[node name="Obstacle2" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
position = Vector2(991, 468)
scale = Vector2(3, 3)

[node name="NavigationObstacle2D2" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle2"]
scale = Vector2(212.05, 141.662)
radius = 164.81
vertices = PackedVector2Array(-0.165055, 0.242361, -0.190207, 0.00470603, -0.158768, -0.240008, 0.00628781, -0.298833, 0.165055, -0.232949, 0.187063, -0.0258832, 0.165055, 0.263538, 0.00785971, 0.282362)
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle2"]
position = Vector2(0.212067, -0.372742)
shape = SubResource("RectangleShape2D_b7f6i")
debug_color = Color(0.882671, 0, 0.228681, 0.42)

[node name="TextureRect" type="TextureRect" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle2"]
light_mask = 8
visibility_layer = 8
offset_left = -48.3333
offset_top = -50.0
offset_right = 451.667
offset_bottom = 450.0
scale = Vector2(0.2, 0.2)
texture = ExtResource("10_cpwqm")

[node name="Obstacle3" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
light_mask = 2
visibility_layer = 2
position = Vector2(400, 400)
scale = Vector2(1.758, 3)

[node name="NavigationObstacle2D3" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle3"]
scale = Vector2(284.414, 190.031)
radius = 127.78
vertices = PackedVector2Array(-0.112, 0.178918, -0.116, -0.168394, 0.11, -0.161377, 0.102, 0.168394)
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle3"]
position = Vector2(-1.13766, -0.33333)
shape = SubResource("RectangleShape2D_7i0lq")
debug_color = Color(1, 0, 0.0627451, 0.419608)

[connection signal="text_submitted" from="CanvasLayer/LineEdit" to="CanvasLayer/LineEdit" method="OnTextSubmitted"]
