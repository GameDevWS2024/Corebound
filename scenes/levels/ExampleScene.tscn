[gd_scene load_steps=13 format=3 uid="uid://dfkwq6qwtxw25"]

[ext_resource type="PackedScene" uid="uid://clfnjh8aelj66" path="res://scenes/prefabs/Player.tscn" id="1_7owxc"]
[ext_resource type="PackedScene" uid="uid://bbj3at63gfo77" path="res://scenes/prefabs/Obstacle.tscn" id="2_k4yms"]
[ext_resource type="PackedScene" uid="uid://dkcg0yrtwyo0k" path="res://scenes/prefabs/PointLight.tscn" id="3_0raeo"]
[ext_resource type="Script" path="res://scripts/Chat.cs" id="4_jkuxm"]
[ext_resource type="Script" path="res://scripts/Ally.cs" id="5_3hn7i"]
[ext_resource type="Texture2D" uid="uid://cwes7vi2s0gjs" path="res://assets/allie.png" id="6_pjkiq"]

[sub_resource type="TileSet" id="TileSet_rvbeq"]
tile_size = Vector2i(5, 5)
physics_layer_0/collision_layer = 0
physics_layer_0/collision_mask = 0
navigation_layer_0/layers = 3

[sub_resource type="NavigationPolygon" id="NavigationPolygon_irpd1"]
outlines = Array[PackedVector2Array]([PackedVector2Array(0.126, -2.51538, 3.56463, -1.27002, 3.978, 2.98022, -2.984, 3.28017, -2.632, -1.66464)])
source_geometry_mode = 1
agent_radius = 100.0

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7ww48"]
size = Vector2(72, 148)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_utqgb"]
size = Vector2(65.2103, 69.961)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_b7f6i"]
size = Vector2(64.8874, 64.3589)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7i0lq"]
size = Vector2(66.5529, 63.3333)

[node name="Node2D" type="Node2D"]

[node name="ColorRect" type="ColorRect" parent="."]
custom_minimum_size = Vector2(5000, 5000)
offset_left = -1280.0
offset_top = -538.0
offset_right = 3720.0
offset_bottom = 4462.0
color = Color(0.099986, 0.099986, 0.099986, 1)

[node name="PointLight2D" parent="." instance=ExtResource("3_0raeo")]
position = Vector2(876, 401)
color = Color(1, 1, 0.847059, 1)
energy = 4.48
texture_scale = 12.14

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="LineEdit" type="LineEdit" parent="CanvasLayer" node_paths=PackedStringArray("_richTextLabel")]
offset_left = -3.0
offset_top = 83.0
offset_right = 245.0
offset_bottom = 185.0
placeholder_text = "Type here to chat"
virtual_keyboard_type = 1
clear_button_enabled = true
script = ExtResource("4_jkuxm")
_systemPromptFile = "res://assets/prompts/example_prompt.txt"
_richTextLabel = NodePath("../RichTextLabel")

[node name="RichTextLabel" type="RichTextLabel" parent="CanvasLayer"]
offset_left = -33.0
offset_top = 198.0
offset_right = 403.0
offset_bottom = 666.0
bbcode_enabled = true
text = "
"

[node name="TileMapLayer" type="TileMapLayer" parent="."]
position = Vector2(-9.53674e-07, -7.62939e-06)
scale = Vector2(0.5, 0.570093)
enabled = false
tile_set = SubResource("TileSet_rvbeq")

[node name="Region" type="NavigationRegion2D" parent="TileMapLayer"]
top_level = true
light_mask = 3
visibility_layer = 3
position = Vector2(168, 305)
scale = Vector2(500, 570.093)
navigation_polygon = SubResource("NavigationPolygon_irpd1")
navigation_layers = 3
travel_cost = 0.0

[node name="MeshInstance2D" type="MeshInstance2D" parent="TileMapLayer/Region"]

[node name="Commander" parent="TileMapLayer/Region/MeshInstance2D" instance=ExtResource("1_7owxc")]
light_mask = 2
visibility_layer = 2
position = Vector2(0.341, 0.44959)
scale = Vector2(0.001, 0.001)
slide_on_ceiling = false
_maxSpeed = 250.0
_acceleration = 1000.0

[node name="Camera2D" type="Camera2D" parent="TileMapLayer/Region/MeshInstance2D/Commander"]
light_mask = 2
visibility_layer = 2
zoom = Vector2(0.8, 0.8)
position_smoothing_enabled = true
position_smoothing_speed = 7.0

[node name="CharacterBody2D" type="CharacterBody2D" parent="TileMapLayer/Region/MeshInstance2D"]
position = Vector2(0.55, 0.926165)
scale = Vector2(0.001, 0.001)
collision_layer = 3
collision_mask = 3
script = ExtResource("5_3hn7i")
_playerPath = NodePath("../Commander")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
path_desired_distance = 1500.0
target_desired_distance = 40.0
path_max_distance = 1500.0
navigation_layers = 3
simplify_path = true
avoidance_enabled = true
radius = 214.58
neighbor_distance = 200.0
avoidance_layers = 3
avoidance_mask = 3

[node name="Sprite2D" type="Sprite2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
position = Vector2(315, 135)
texture = ExtResource("6_pjkiq")
offset = Vector2(135, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/CharacterBody2D"]
position = Vector2(454, 141)
shape = SubResource("RectangleShape2D_7ww48")

[node name="Obstacles" type="Node" parent="TileMapLayer/Region/MeshInstance2D"]

[node name="Obstacle" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
position = Vector2(703, 262)
scale = Vector2(2.33092, 1.47225)
collision_layer = 3
collision_mask = 3

[node name="NavigationObstacle2D" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle"]
scale = Vector2(214.508, 387.226)
radius = 100.0
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle"]
position = Vector2(-1.28705, -2.37732)
shape = SubResource("RectangleShape2D_utqgb")

[node name="Obstacle2" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
position = Vector2(991, 468)
scale = Vector2(2.35793, 4.02431)

[node name="NavigationObstacle2D2" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle2"]
scale = Vector2(212.05, 141.662)
radius = 164.81
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle2"]
position = Vector2(0.212067, -0.372742)
shape = SubResource("RectangleShape2D_b7f6i")

[node name="Obstacle3" parent="TileMapLayer/Region/MeshInstance2D/Obstacles" instance=ExtResource("2_k4yms")]
light_mask = 2
visibility_layer = 2
position = Vector2(242, -155)
scale = Vector2(1.758, 3)

[node name="NavigationObstacle2D3" type="NavigationObstacle2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle3"]
scale = Vector2(284.414, 190.031)
radius = 127.78
affect_navigation_mesh = true
carve_navigation_mesh = true
avoidance_layers = 3

[node name="CollisionShape2D2" type="CollisionShape2D" parent="TileMapLayer/Region/MeshInstance2D/Obstacles/Obstacle3"]
position = Vector2(0.284409, 0.66666)
shape = SubResource("RectangleShape2D_7i0lq")

[connection signal="text_submitted" from="CanvasLayer/LineEdit" to="CanvasLayer/LineEdit" method="OnTextSubmitted"]
